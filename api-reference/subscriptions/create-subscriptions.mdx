---
title: 'Create/Update Subscriptions'
api: 'POST /api/v1/subscriptions'
description: 'Batch create or update subscription records'
---

## Request Body

<ParamField body="subscriptions" type="array" required>
  Array of subscription objects to create or update
  
  <Expandable title="Subscription Object">
    <ParamField body="externalCompanyId" type="string" required>
      External ID of the company
    </ParamField>
    
    <ParamField body="externalAccountId" type="string">
      External ID of the account (optional)
    </ParamField>
    
    <ParamField body="planKey" type="string" required>
      The key of the plan this subscription is for
    </ParamField>
    
    <ParamField body="status" type="string" required>
      Subscription status: `trialing`, `active`, `past_due`, `paused`, `cancelled`, or `ended`
    </ParamField>
    
    <ParamField body="currency" type="string">
      Currency code (e.g., "USD", "EUR")
    </ParamField>
    
    <ParamField body="billingInterval" type="string">
      Billing frequency: `month`, `year`, or `one_time`
    </ParamField>
    
    <ParamField body="billingIntervalCount" type="number">
      Number of billing intervals. Default: 1
    </ParamField>
    
    <ParamField body="contractValue" type="number">
      Contract value in major currency units (automatically converted to minor units)
    </ParamField>
    
    <ParamField body="currentPeriodStartAt" type="string">
      ISO 8601 timestamp for the current period start
    </ParamField>
    
    <ParamField body="currentPeriodEndAt" type="string">
      ISO 8601 timestamp for the current period end
    </ParamField>
    
    <ParamField body="externalSubscriptionId" type="string">
      External subscription ID from billing provider (e.g., Stripe)
    </ParamField>
    
    <ParamField body="cancelledAt" type="string">
      ISO 8601 timestamp when the subscription was cancelled
    </ParamField>
    
    <ParamField body="metadata" type="object">
      Custom key-value metadata
    </ParamField>
    
    <ParamField body="entitlementsOverrideJson" type="object">
      Optional entitlements overrides for this specific subscription. If omitted, plan-level entitlements apply.
      
      <Expandable title="Entitlements Override Array">
        <ParamField body="usage_key" type="string">
          The usage metric key to override (e.g., "image_analysis_count", "storage_gb")
        </ParamField>
        
        <ParamField body="quantity" type="number">
          The custom limit or quota for this subscription (optional, can be null for unlimited)
        </ParamField>
        
        <ParamField body="validity_interval" type="string">
          Time unit: `month`, `year`, or `one_time` (optional)
        </ParamField>
        
        <ParamField body="validity_interval_count" type="number">
          Number of validity intervals (optional)
        </ParamField>
      </Expandable>
    </ParamField>
  </Expandable>
</ParamField>

## Example Request

```bash
curl -X POST https://api.arali.ai/api/v1/subscriptions \
  -H "Authorization: Bearer YOUR_API_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "subscriptions": [
      {
        "externalCompanyId": "acme-corp",
        "externalAccountId": "acme-enterprise-account",
        "planKey": "premium",
        "status": "active",
        "currency": "USD",
        "billingInterval": "month",
        "billingIntervalCount": 1,
        "contractValue": 99.99,
        "currentPeriodStartAt": "2024-01-01T00:00:00Z",
        "currentPeriodEndAt": "2024-02-01T00:00:00Z",
        "externalSubscriptionId": "stripe_sub_123",
        "entitlementsOverrideJson": [
          {
            "usage_key": "image_analysis_count",
            "quantity": 50000,
            "validity_interval": "month",
            "validity_interval_count": 1
          }
        ],
        "metadata": {
          "source": "stripe",
          "customField": "value"
        }
      },
      {
        "externalCompanyId": "basic-customer",
        "planKey": "basic",
        "status": "active",
        "currency": "USD",
        "billingInterval": "month",
        "currentPeriodStartAt": "2024-01-01T00:00:00Z",
        "currentPeriodEndAt": "2024-02-01T00:00:00Z"
      }
    ]
  }'
```

## Response

Returns the created/updated subscription records.

## Notes

- Contract values are automatically converted to minor currency units (cents for USD, no conversion for JPY)
- Example: USD 99.99 â†’ stored as 9999 cents
- **`entitlementsOverrideJson` is optional**: If omitted, the subscription uses the plan's default entitlements
- **Entitlement overrides** allow per-subscription customization (e.g., giving a customer 50,000 images instead of the plan's default 10,000)
